import{_ as ge}from"./eeer9vDV.js";import{R as ve}from"./CyGyADv7.js";import he from"./CtKPMTXP.js";import re from"./BPMURVZB.js";import fe from"./C5yD6Val.js";import _e from"./D3b98cz8.js";import ce from"./Bfk8XPW3.js";import ue from"./CKsix2gl.js";import{_ as ie}from"./CTkmXBim.js";import{j as r,y as te,D as de,B as V,s as se,l as oe,o as f,w as m,c as $,a as t,b as i,t as b,F as we,r as xe,p as O,d as ye,K as be,x as j,q as ke,A as $e,m as Ce,E as Ie}from"./CoyVHb3q.js";import Ve from"./CFLfJkUz.js";import Le from"./CjRHu3jc.js";import Se from"./DvP3aKSQ.js";import qe from"./eS8pf6c8.js";const Ue=""+new URL("no-item.C-q5xNqU.jpg",import.meta.url).href,je={class:"flex items-center gap-4"},Te={class:"text-xl font-semibold"},Qe={class:"text-blue-500"},Ae={key:0,class:"flex flex-col items-center justify-center text-center space-y-6 p-6"},Ee={class:"flex gap-4 justify-center"},Ne={key:1,class:"space-y-4"},We={class:"flex items-center w-full justify-between"},Pe={class:"flex justify-end"},Be={class:"flex items-center w-full"},De=["alt","src"],Me={class:"w-full"},Oe={class:"scroll-area max-h-[60vh] overflow-y-auto pr-2"},ze={class:"flex"},Re={class:"font-semibold text-sm pr-2"},Fe=["src"],He={class:"font-semibold text-sm"},Je={class:"text-sm text-gray-500"},Ke={class:"flex items-center gap-2 sm:flex-row flex-col-reverse"},Ye={class:"flex sm:flex-row flex-col items-center gap-1"},Ge={key:1,class:"flex justify-center"},Xe={class:"flex justify-end space-x-2 pt-4 border-t mt-4"},Ze={key:0,class:"text-red-600 text-sm ml-2"},et={__name:"QuotationDialog",emits:["close"],setup(pe,{emit:ae}){const C=r(!0),g=r(!1),B=r(""),w=te(),I=r([]),c=r("");de(async()=>{await w.getCategories(),await H()});const z=ae,_=r([]),L=r(null),Y=l=>{const o=l.value;_.value.some(d=>d.id===o.id)||(_.value.push({...o,quantity:1}),Q.value="")},T=()=>{C.value=!1},A=()=>{g.value=!0},S=l=>{_.value[l].quantity++},G=l=>{_.value[l].quantity>1&&_.value[l].quantity--},R=l=>{_.value.splice(l,1)},X=async()=>{c.value.trim()||(L.value="Message cannot be empty!"),(await w.makeQuotation(c.value,_.value)).status==201?(C.value=!1,c.value="",_.value=[],z("close",!1)):L.value="Failed to submit quotation. Please try again."},F=V(()=>_.value.filter(l=>l.name.toLowerCase().includes(B.value.toLowerCase()))),D=se(),Z=V(()=>{const{firstName:l,lastName:o}=D.user;return`${(l==null?void 0:l.charAt(0))||""}${(o==null?void 0:o.charAt(0))||""}`.toUpperCase()}),Q=r(""),v=r([]),H=async()=>{try{await w.getCategories(),I.value=w.categories}catch(l){console.error("Error fetching categories:",l)}},E=r([]),J=async l=>{var d,N;let o=l.query;E.value=[];const{$axios:q}=j();if(o)try{let k;const W=Array.isArray(v==null?void 0:v.value)?v.value.filter(s=>s.id!==null).map(s=>s.id):(d=v==null?void 0:v.value)!=null&&d.id&&v.value.id!==null?[v.value.id]:[],U="https://www.shutterstock.com/shutterstock/photos/2059817444/display_1500/stock-vector-no-image-available-photo-coming-soon-illustration-vector-2059817444.jpg";if(W.length>0)k=await q.get("/product",{params:{searchTerm:o,categoryId:W}}),E.value=k.data.results.flatMap(s=>s.models.map(e=>({id:e.id,name:`${s.name} - (${e.name})`,images:e.images.length>0?e.images.map(n=>n.uploadUrl):[U]})));else{k=await q.get("/product/product-models",{params:{searchTerm:o}});const s=((N=k.data)==null?void 0:N.results)??[];E.value=s.map(e=>{var n,u,x,p;return{id:e.id,name:e.product.name,price:e.price,category:((x=(u=(n=e.product)==null?void 0:n.subCategory)==null?void 0:u.category)==null?void 0:x.name)??"Unknown",images:e.images.length>0?((p=e.images.find(P=>P.isPrimary))==null?void 0:p.uploadUrl)||U:[U]}})}}catch(k){console.error("Error fetching products:",k)}},ee=async()=>{try{const{$axios:l}=j(),o=await l.get("/product",{params:{searchTerm:Q.value}})}catch(l){console.error("Error fetching products:",l)}};return(l,o)=>{const q=qe,d=ce,N=re,k=ue,W=Se,U=Le,s=Ve;return f(),oe(s,{visible:C.value,"onUpdate:visible":o[3]||(o[3]=e=>C.value=e),modal:"",class:"w-full md:w-[60vw] lg:w-[50vw]",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{header:m(()=>[t("div",je,[i(q,{label:Z.value,class:"bg-blue-100 text-blue-700 font-bold",shape:"circle",size:"xlarge"},null,8,["label"]),t("h3",Te,[o[4]||(o[4]=ye(" Welcome Back ")),t("span",Qe,b(be(D).user.firstName),1)])])]),default:m(()=>[g.value?(f(),$("div",Ne,[t("div",We,[o[7]||(o[7]=t("h3",{class:"text-xl font-semibold mr-4"},"Search items",-1)),t("div",Pe,[i(N,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=e=>v.value=e),options:I.value,optionLabel:"name",placeholder:"Choose Category",class:"min-w-[150px] z-10 rounded-l-md mr-3 border-l"},null,8,["modelValue","options"]),i(k,{modelValue:Q.value,"onUpdate:modelValue":o[1]||(o[1]=e=>Q.value=e),onInput:ee,suggestions:E.value,onComplete:J,optionLabel:"name",placeholder:"I'm Searching for ...",class:"flex-grow mx-2 p-input-icon-left",onItemSelect:Y},{option:m(e=>[t("div",Be,[t("img",{alt:e.option.name,src:e.option.images,class:"mr-2 rounded-md",style:{width:"40px",height:"40px","object-fit":"cover"}},null,8,De),t("div",Me,b(e.option.name),1)])]),_:1},8,["modelValue","suggestions"])])]),i(W),t("div",Oe,[F.value.length>0?(f(!0),$(we,{key:0},xe(F.value,(e,n)=>(f(),$("div",{key:e.id,class:"flex justify-between items-center border-b pb-2 mb-2"},[t("div",ze,[t("h4",Re,b(n+1),1),t("img",{src:e.images[0],class:"mr-2",height:"25px",width:"25px"},null,8,Fe),t("div",null,[t("h4",He,b(e.name),1),t("p",Je,b(e.description),1)])]),t("div",Ke,[t("div",Ye,[i(d,{icon:"pi pi-plus",class:"p-button-rounded p-button-sm !p-0.5 !h-6 !w-6 !text-xs",onClick:u=>S(n),variant:"outlined"},null,8,["onClick"]),i(U,{modelValue:e.quantity,"onUpdate:modelValue":u=>e.quantity=u,modelModifiers:{number:!0},class:"w-12 h-6 text-center text-xs"},null,8,["modelValue","onUpdate:modelValue"]),i(d,{icon:"pi pi-minus",class:"p-button-rounded p-button-sm !p-0.5 !h-6 !w-6 !text-xs",onClick:u=>G(n)},null,8,["onClick"])]),i(d,{icon:"pi pi-trash",class:"p-button-danger p-button-rounded p-button-sm !p-0.5 !h-6 !w-6 !text-xs",onClick:u=>R(n)},null,8,["onClick"])])]))),128)):(f(),$("div",Ge,o[8]||(o[8]=[t("img",{src:Ue,alt:"Empty Cart",class:"max-w-full h-auto w-24 sm:w-32 md:w-48 lg:w-64 mb-4"},null,-1)])))]),t("div",Xe,[t("div",null,[i(U,{type:"text",modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=e=>c.value=e),placeholder:"Attach Message"},null,8,["modelValue"]),L.value?(f(),$("div",Ze,b(L.value),1)):O("",!0)]),i(d,{label:"Place Quotation",class:"p-button-success",onClick:X,disabled:_.value.length===0},null,8,["disabled"])])])):(f(),$("div",Ae,[o[5]||(o[5]=t("img",{src:"https://cdn-icons-png.flaticon.com/512/942/942748.png",alt:"Quotation Illustration",class:"w-40 h-40 mx-auto"},null,-1)),o[6]||(o[6]=t("p",{class:"text-lg"},"Do you wish to make a quotation?",-1)),t("div",Ee,[i(d,{label:"Yes",class:"p-button-success",onClick:A}),i(d,{label:"No",class:"p-button-secondary",onClick:T})])]))]),_:1},8,["visible"])}}},tt={class:"bg-white"},st={class:"container mx-auto px-2 py-4"},ot={class:"md:hidden flex items-center justify-between w-full"},at={class:"flex-row justify-center"},lt={class:"flex items-center w-full"},nt=["alt","src"],it={class:"w-full"},rt={class:"hidden md:flex items-center"},ct={class:"mr-auto md:w-48 flex-shrink-0"},ut={class:"w-full bg-red flex justify-center items-center py-4"},dt={class:"relative flex items-center w-"},pt={class:"flex items-center w-full"},mt=["alt","src"],gt={class:"w-full"},vt={class:"hidden md:flex lg:flex w-1/5 justify-between items-center p-4"},ht={key:0,class:"absolute top-0 right-0 bg-red-500 text-white text-xs px-1.5 rounded-full"},ft={class:"ml-4 hidden sm:flex flex-col font-bold"},jt={__name:"Navbar",props:{},emits:["update:searchTerm"],setup(pe,{emit:ae}){const C=r(!1),g=te(),B=r([]),w=se(),I=r(""),c=r([]);r(!1);const z=r([]),_=V(()=>g.cartCount),L=V(()=>g.cartTotal),Y=V(()=>{var s;return((s=w.user)==null?void 0:s.shopOwnerVerified)??!1}),T=r([]),A=V(()=>g.wishListCount),S=Ie(),{$formatPrice:G}=j(),R=r(),X=s=>{R.value.toggle(s)},F=async()=>{try{await g.getCategories(),z.value=g.categories}catch(s){console.error("Error fetching categories:",s)}},D=s=>G(s),Z=r(0),Q=s=>{!c.value||!c.value.id?S.push({path:`/products/${s.value.id}`}):S.push({path:`/results/${c.value.id}`,query:{searchTerm:I.value.name,productId:s.value.id}})};r(!1);const v=()=>{C.value=!0},H=async()=>{try{const{$axios:s}=j(),e=await s.get("/product",{params:{searchTerm:I.value}})}catch(s){console.error("Error fetching products:",s)}},E=async()=>{try{const{$axios:s}=j(),e=await s.get("/product/cart"),n=100;Z.value=e.data.reduce((u,x)=>u+x.quantity*n,0)}catch(s){console.error("Error fetching cart items:",s)}},J=async s=>{var u,x;let e=s.query;T.value=[];const{$axios:n}=j();if(e)try{let p;const P=Array.isArray(c==null?void 0:c.value)?c.value.filter(y=>y.id!==null).map(y=>y.id):(u=c==null?void 0:c.value)!=null&&u.id&&c.value.id!==null?[c.value.id]:[],M="https://www.shutterstock.com/shutterstock/photos/2059817444/display_1500/stock-vector-no-image-available-photo-coming-soon-illustration-vector-2059817444.jpg";if(P.length>0)p=await n.get("/product",{params:{searchTerm:e,categoryId:P}}),T.value=p.data.results.flatMap(y=>y.models.map(h=>({id:h.id,name:`${y.name} - (${h.name})`,images:h.images.length>0?h.images.map(a=>a.uploadUrl):[M]})));else{p=await n.get("/product/product-models",{params:{searchTerm:e}});const y=((x=p.data)==null?void 0:x.results)??[];T.value=y.map(h=>{var a,K,le,ne;return{id:h.id,name:h.product.name,price:h.price,category:((le=(K=(a=h.product)==null?void 0:a.subCategory)==null?void 0:K.category)==null?void 0:le.name)??"Unknown",images:h.images.length>0?((ne=h.images.find(me=>me.isPrimary))==null?void 0:ne.uploadUrl)||M:[M]}})}}catch(p){console.error("Error fetching products:",p)}},ee=()=>w.logout(),l=async()=>{if(w.isLoggedIn)if(typeof window<"u"){const s=localStorage.getItem("wishlist"),e=s?JSON.parse(s):[];if(console.log("Wishlist IDs:",e),Array.isArray(e)&&e.length>0){for(let n=0;n<e.length;n++)U(e[n]);localStorage.removeItem("wishlist")}else console.log("Wishlist is empty or invalid.");return!0}else return console.error("LocalStorage is not available in the current context."),!1;else return console.log("No token found. User is not logged in."),!1},o=()=>{S.push({path:"/wishlist"})},q=()=>{w.user.shopOwnerVerified?S.push({path:"/quotation"}):S.push({path:"/cart"})},d=()=>{S.push({path:"/my-account"})},N=V(()=>`Welcome ${w.isLoggedIn?w.user.firstName:"User"}`),k=r([{label:N,items:[{label:"My Account",icon:"pi pi-user",command:d},{label:"Wishlist",icon:"pi pi-heart",command:o,badge:V(()=>A.value>0?A.value:null)},{label:"Cart",icon:"pi pi-shopping-cart",command:q,badge:V(()=>L.value>0?L.value:null)},{label:"Log out",icon:"pi pi-sign-out",command:ee}]}]),W=async()=>{try{const{$axios:s}=j(),e=await s.get("/product/wishlist")}catch(s){console.error("Error fetching wishlist:",s);const e=JSON.parse(localStorage.getItem("wishlist"))||[];A.value=e.length}},U=async s=>{const e=te();se();const{res:n}=await e.addToWishlist(s);await e.getWishList();try{const{$axios:u}=j(),x={productId:s},p=await u.post("/product/wishlist/add",x);console.log("Done",p)}catch(u){console.error("Error adding product to wishlist:",u)}};return de(async()=>{await g.getProducts(),await g.getCategories(),await g.getCartItems(),await g.getWishList(),await l(),await E(),await W(),await F(),await g.getQuotation()}),(s,e)=>{const n=ge,u=ue,x=ce,p=_e,P=fe,M=re,y=he,h=ve;return f(),$("header",tt,[t("div",st,[t("div",ot,[i(n,{to:"/dashboard"},{default:m(()=>e[5]||(e[5]=[t("img",{src:ie,alt:"Hikvision Logo",class:"h-16 object-contain"},null,-1)])),_:1,__:[5]}),t("div",at,[i(u,{modelValue:I.value,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),onInput:H,suggestions:T.value,onComplete:J,optionLabel:"name",placeholder:"I'm Searching for ...",class:"flex-grow mx-2 p-input-icon-left",onItemSelect:Q},{option:m(a=>[t("div",lt,[t("img",{alt:a.option.name,src:a.option.images,class:"mr-2 rounded-md",style:{width:"40px",height:"40px","object-fit":"cover"}},null,8,nt),t("div",it,b(a.option.name),1)])]),_:1},8,["modelValue","suggestions"])]),i(x,{type:"button",icon:"pi pi-bars",onClick:X,"aria-haspopup":"true","aria-controls":"overlay_menu",class:"bg-transparent border-none shadow-none p-2 text-black"}),i(P,{ref_key:"menu",ref:R,id:"overlay_menu",model:k.value,popup:!0,class:"wmd:w-60"},{item:m(({item:a,props:K})=>[ke((f(),$("a",$e({class:"flex items-center"},K.action),[t("span",{class:Ce(a.icon)},null,2),t("span",null,b(a.label),1),a.badge?(f(),oe(p,{key:0,class:"ml-auto",value:D(a.badge),severity:"warning"},null,8,["value"])):O("",!0),a.count?(f(),oe(p,{key:1,class:"ml-auto",value:s.count,severity:"warning"},null,8,["value"])):O("",!0)],16)),[[h]])]),_:1},8,["model"])]),t("div",rt,[t("div",ct,[i(n,{to:"/dashboard"},{default:m(()=>e[6]||(e[6]=[t("img",{src:ie,alt:"Hikvision Logo",class:"h-20 object-contain"},null,-1)])),_:1,__:[6]})]),t("div",ut,[t("div",dt,[i(M,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a),options:z.value,optionLabel:"name",placeholder:"Choose Category",class:"min-w-[150px] z-10 rounded-l-md mr-3 border-l"},null,8,["modelValue","options"]),i(u,{modelValue:I.value,"onUpdate:modelValue":e[2]||(e[2]=a=>I.value=a),onInput:H,suggestions:T.value,onComplete:J,optionLabel:"name",placeholder:"I'm Searching for ...",class:"flex-grow p-input-icon-left border-l-10 border-r-0",onItemSelect:Q},{dropdownicon:m(()=>e[7]||(e[7]=[t("i",{class:"pi pi-chevron-down text-gray-500"},null,-1)])),option:m(a=>[t("div",pt,[t("img",{alt:a.option.name,src:a.option.images,class:"mr-2 rounded-md",style:{width:"40px",height:"40px","object-fit":"cover"}},null,8,mt),t("div",gt,b(a.option.name),1)])]),_:1},8,["modelValue","suggestions"])])]),t("nav",vt,[i(n,{onClick:d,class:"cursor-pointer"},{default:m(()=>e[8]||(e[8]=[t("i",{class:"pi pi-user text-3xl"},null,-1)])),_:1,__:[8]}),i(n,{onClick:o,class:"cursor-pointer"},{default:m(()=>[i(y,{value:A.value,severity:"danger"},{default:m(()=>e[9]||(e[9]=[t("i",{class:"pi pi-heart text-3xl"},null,-1)])),_:1,__:[9]},8,["value"])]),_:1}),i(n,{onClick:q,class:"cursor-pointer"},{default:m(()=>[i(y,{value:_.value,severity:"danger"},{default:m(()=>e[10]||(e[10]=[t("i",{class:"pi pi-shopping-cart text-3xl"},null,-1)])),_:1,__:[10]},8,["value"])]),_:1}),Y.value?(f(),$("button",{key:0,onClick:v,class:"relative text-3xl text-gray-700 hover:text-blue-600"},[e[11]||(e[11]=t("i",{class:"pi pi-clipboard text-3xl"},null,-1)),B.value.length?(f(),$("span",ht,b(B.value.length),1)):O("",!0)])):O("",!0)]),t("div",ft,[e[12]||(e[12]=t("span",{class:"text-xs text-gray-400"},"My Cart",-1)),t("span",null,"Ksh "+b(D(L.value)),1)])])]),e[13]||(e[13]=t("hr",null,null,-1)),i(et,{visible:C.value,"onUpdate:visible":e[3]||(e[3]=a=>C.value=a),quotationList:B.value,onClose:e[4]||(e[4]=a=>C.value=!1)},null,8,["visible","quotationList"])])}}};export{jt as _};
