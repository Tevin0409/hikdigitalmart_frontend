import E from"./DVs2OJRz.js";import M from"./Bfk8XPW3.js";import j from"./B3fgAOjB.js";import{_ as B,c as x,b as T,a as o,w as I,q as d,v as c,F as L,r as D,p as U,d as S,t as i,I as F,j as v,x as K,s as z,y as G,B as O,C as R,D as Y,z as H,o as b,l as J,A as q,m as Q}from"./CoyVHb3q.js";import{_ as W}from"./CTkmXBim.js";import"./Be1fzYNM.js";import"./DGEOgZpe.js";import"./DwP0r8OC.js";import"./DBllE-4O.js";import"./DTr9jwMw.js";import"./B-x3AKLp.js";import"./BU7HOwbj.js";import"./Bo6vk6Ju.js";import"./BM2ClVBI.js";import"./CyGyADv7.js";import"./C4furr1e.js";import"./DmfvTtO6.js";import"./3A9dI5Hm.js";import"./D3b98cz8.js";import"./8x9NGM2Z.js";const X={setup(){const m=v(!1),{$formatPrice:e}=K(),k=z(),r=G(),A=O(()=>r.cartTotal),N=O(()=>r.cartItems),u=v(!1),s=O(()=>k.user||{}),V=v({icon:"pi pi-home",route:"/dashboard"}),C=v([{label:"Cart",route:"/cart"},{label:"Checkout",route:"/checkout"}]),h=a=>e(a),t=["firstName","lastName","email","phoneNumber"],p=a=>a*.16,f=v(""),g=()=>{f.value==="DISCOUNT10"?(N.value.forEach(a=>{a.product.price=a.product.price*.9}),alert("Coupon applied: 10% discount!")):alert("Invalid coupon code.")},n=R(),w=async()=>{const a=k.isLoggedIn;if(console.log("isVat.value,",u.value),a){s.value={...s.value,isVat:u.value};try{m.value=!0;let y={orderId:(await r.placeOrder(s.value,u.value)).data.id,amount:1,phoneNumber:s.value.phoneNumber};const _=await r.checkOut(y);m.value=!1,n.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(l){console.log("Error placing order:",l),m.value=!1,n.add({severity:"error",summary:"Error placing order",detail:l.message,group:"br",life:3e3})}}else{if(!s.value||Object.keys(s.value).length===0){n.add({severity:"warn",summary:"Please Enter your details to place an order.",group:"br",life:3e3});return}for(const l of t)if(!s.value[l]){n.add({severity:"warn",summary:`${l} is required to place an order.`,group:"br",life:3e3});return}try{s.value={...s.value,isVat:u.value},m.value=!0;let y={orderId:(await r.placeOrderAnonymous(s.value,u.value)).data.id,amount:1,phoneNumber:s.value.phoneNumber};const _=await r.checkOut(y);m.value=!1,n.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(l){console.log("Error placing order:",l),m.value=!1,n.add({severity:"error",summary:"Error placing order",detail:l.message,group:"br",life:3e3})}}};return Y(()=>{}),{user:s,cartItems:N,cartTotal:A,coupon:f,applyCoupon:g,placeOrder:w,formattedPrice:h,loading:m,defaultImage:W,home:V,items:C,getVat:p,isVat:u}}},Z={class:"container mx-auto pt-12"},$=["href","onClick"],ee={class:"text-primary font-semibold"},oe=["href","target"],te={class:"text-surface-700 dark:text-surface-0"},re={class:"checkout-container flex flex-col md:flex-row gap-8 p-4 md:p-8"},se={class:"billing-details flex-1 bg-white p-6 rounded-lg shadow mb-4"},le={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ae={class:"form-group"},ne={class:"form-group"},de={class:"form-group"},ie={class:"form-group"},me={class:"form-group"},ue={class:"form-group"},ce={class:"form-group"},pe={class:"form-group"},fe={class:"cart-summary bg-white p-6 flex-1 rounded-lg w-full md:max-w-sm shadow"},be={class:"cart-items space-y-4"},ge=["src","alt"],ye={class:"flex-1 text-center sm:text-left"},xe={class:"text-sm"},ve={class:"flex justify-between"},he={class:"text-gray-600 text-xs"},we={class:"text-sm"},_e={class:"cart-summary-bottom mt-4"},ke={class:"flex justify-between text-sm"},Ne={class:"text-lg"},Ve={class:"flex items-center justify-between my-4"},Ce={class:"relative inline-flex items-center cursor-pointer"},Pe={key:0,class:"my-2"},Te={key:1,class:"flex justify-between text-gray-600"},Oe={class:"flex justify-between text-lg font-semibold"},Ae={class:"text-lg"},Ie={class:"payment-methods flex flex-col sm:flex-row items-center gap-2 mt-4"},Ue={class:"text-sm font-medium"};function Se(m,e,k,r,A,N){var h;const u=H("router-link"),s=j,V=M,C=E;return b(),x("div",Z,[T(s,{home:r.home,model:r.items},{item:I(({item:t,props:p})=>[t.route?(b(),J(u,{key:0,to:t.route,custom:""},{default:I(({href:f,navigate:g})=>[o("a",q({href:f},p.action,{onClick:g}),[o("span",{class:Q([t.icon,"text-color"])},null,2),o("span",ee,i(t.label),1)],16,$)]),_:2},1032,["to"])):(b(),x("a",q({key:1,href:t.url,target:t.target},p.action),[o("span",te,i(t.label),1)],16,oe))]),_:1},8,["home","model"]),o("div",re,[o("div",se,[e[18]||(e[18]=o("h2",{class:"text-xl font-semibold mb-4"},"Billing Details",-1)),o("form",le,[o("div",ae,[e[10]||(e[10]=o("label",{for:"first-name",class:"block text-sm font-medium mb-1"},"First Name*",-1)),d(o("input",{type:"text",id:"first-name","onUpdate:modelValue":e[0]||(e[0]=t=>r.user.firstName=t),placeholder:"First Name",required:"",class:"w-full p-2 border rounded"},null,512),[[c,r.user.firstName]])]),o("div",ne,[e[11]||(e[11]=o("label",{for:"last-name",class:"block text-sm font-medium mb-1"},"Last Name*",-1)),d(o("input",{type:"text",id:"last-name","onUpdate:modelValue":e[1]||(e[1]=t=>r.user.lastName=t),placeholder:"Last Name",required:"",class:"w-full p-2 border rounded"},null,512),[[c,r.user.lastName]])]),o("div",de,[e[12]||(e[12]=o("label",{for:"company-name",class:"block text-sm font-medium mb-1"},"Company Name",-1)),d(o("input",{type:"text",id:"company-name","onUpdate:modelValue":e[2]||(e[2]=t=>r.user.company_name=t),placeholder:"Company Name",class:"w-full p-2 border rounded"},null,512),[[c,r.user.company_name]])]),o("div",ie,[e[13]||(e[13]=o("label",{for:"street-address",class:"block text-sm font-medium mb-1"},"Street Address*",-1)),d(o("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>r.user.street_address=t),id:"street-address",placeholder:"Street Address",required:"",class:"w-full p-2 border rounded"},null,512),[[c,r.user.street_address]])]),o("div",me,[e[14]||(e[14]=o("label",{for:"apartment",class:"block text-sm font-medium mb-1"},"Apartment, floor, etc. (optional)",-1)),d(o("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>r.user.apartment=t),id:"apartment",placeholder:"Apartment, floor, etc.",class:"w-full p-2 border rounded"},null,512),[[c,r.user.apartment]])]),o("div",ue,[e[15]||(e[15]=o("label",{for:"city",class:"block text-sm font-medium mb-1"},"Town/City*",-1)),d(o("input",{type:"text",id:"city","onUpdate:modelValue":e[5]||(e[5]=t=>r.user.town=t),placeholder:"Town/City",required:"",class:"w-full p-2 border rounded"},null,512),[[c,r.user.town]])]),o("div",ce,[e[16]||(e[16]=o("label",{for:"phone",class:"block text-sm font-medium mb-1"},"Phone Number*",-1)),d(o("input",{type:"tel",id:"phone","onUpdate:modelValue":e[6]||(e[6]=t=>r.user.phoneNumber=t),placeholder:"Phone Number",required:"",class:"w-full p-2 border rounded"},null,512),[[c,r.user.phoneNumber]])]),o("div",pe,[e[17]||(e[17]=o("label",{for:"email",class:"block text-sm font-medium mb-1"},"Email Address*",-1)),d(o("input",{type:"email",id:"email","onUpdate:modelValue":e[7]||(e[7]=t=>r.user.email=t),placeholder:"Email Address",required:"",class:"w-full p-2 border rounded"},null,512),[[c,r.user.email]])])])]),o("div",fe,[e[27]||(e[27]=o("h3",{class:"text-lg font-semibold mb-4"},"Cart Summary",-1)),o("div",be,[(b(!0),x(L,null,D(r.cartItems,t=>{var p,f,g,n,w,a,l,y,_;return b(),x("div",{key:t.id,class:"cart-item flex flex-col sm:flex-row items-center gap-4 border-b pb-3"},[o("img",{src:((g=(f=(p=t.productModel)==null?void 0:p.images)==null?void 0:f.find(P=>P.isPrimary))==null?void 0:g.uploadUrl)??((w=(n=t==null?void 0:t.images)==null?void 0:n.find(P=>P.isPrimary))==null?void 0:w.uploadUrl),alt:((a=t.productModel)==null?void 0:a.name)||"Product Image",class:"w-full h-40 object-cover"},null,8,ge),o("div",ye,[o("p",xe,i(((l=t==null?void 0:t.productModel)==null?void 0:l.name)??t.name),1),o("div",ve,[o("p",he," Ksh "+i(r.formattedPrice(((y=t.productModel)==null?void 0:y.price)??t.price)),1),o("p",we,i(((_=t==null?void 0:t.productModel)==null?void 0:_.quantity)??t.quantity),1)])])])}),128))]),o("div",_e,[o("p",ke,[e[19]||(e[19]=S(" Subtotal ")),o("strong",Ne,i(r.formattedPrice(r.cartTotal)),1)]),o("div",Ve,[e[22]||(e[22]=o("label",{class:"text-gray-600"},"Apply VAT (16%)",-1)),o("label",Ce,[d(o("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>r.isVat=t),class:"sr-only peer"},null,512),[[F,r.isVat]]),e[20]||(e[20]=o("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-primary transition-colors"},null,-1)),e[21]||(e[21]=o("div",{class:"absolute left-1 top-1 bg-white border border-gray-300 w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5"},null,-1))])]),r.isVat?(b(),x("hr",Pe)):U("",!0),r.isVat?(b(),x("div",Te,[e[23]||(e[23]=o("span",null,"VAT",-1)),o("span",null,"Ksh "+i(r.formattedPrice(r.getVat(r.cartTotal))),1)])):U("",!0),e[26]||(e[26]=o("hr",{class:"my-2"},null,-1)),o("p",Oe,[e[24]||(e[24]=S(" Total ")),o("strong",Ae,"Ksh "+i(r.formattedPrice(r.cartTotal+(r.isVat?r.getVat(r.cartTotal):0))),1)]),o("div",Ie,[e[25]||(e[25]=o("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/512px-M-PESA_LOGO-01.svg.png?20191120100524",class:"w-16 sm:w-1/4",alt:"M-Pesa"},null,-1)),o("label",Ue,i((h=r.user)==null?void 0:h.phoneNumber),1)]),T(V,{type:"button",class:"place-order-btn w-full bg-green-600 text-white py-2 mt-4 rounded-lg hover:bg-green-700",label:"Place Order",loading:r.loading,onClick:e[9]||(e[9]=t=>r.placeOrder())},null,8,["loading"])])])]),T(C,{position:"top-right",group:"br"})])}const eo=B(X,[["render",Se],["__scopeId","data-v-4bf4c4fa"]]);export{eo as default};
