import{s as q}from"./BgyHQo7A.js";import{s as A}from"./SnT-zCAS.js";import{s as E}from"./D0n04TQB.js";import{_ as L,r as v,y as B,x as j,J as F,S as C,W as D,U as G,q as K,c as h,b as O,w as U,a as e,N as u,X as c,F as R,m as Y,d as V,t as d,o as g,G as z,u as J,v as M}from"./FHiXbJVU.js";import{_ as W}from"./ClKkv-OH.js";import"./DhZXlDba.js";import"./BnLU7Cin.js";import"./D0QSSvi6.js";import"./D0Uk6Uyk.js";const X={setup(){const i=v(!1),{$formatPrice:o}=B(),_=j(),s=F(),I=C(()=>s.cartTotal),w=C(()=>s.cartItems),a=C(()=>_.user||{}),k=v({icon:"pi pi-home",route:"/dashboard"}),N=v([{label:"Cart",route:"/cart"},{label:"Checkout",route:"/checkout"}]),P=n=>o(n),y=["firstName","lastName","email","phoneNumber"],t=n=>n*.16,m=v(""),p=()=>{m.value==="DISCOUNT10"?(w.value.forEach(n=>{n.product.price=n.product.price*.9}),alert("Coupon applied: 10% discount!")):alert("Invalid coupon code.")},l=D(),x=async()=>{if(_.isLoggedIn)try{i.value=!0;let f={orderId:(await s.placeOrder(a.value)).data.id,amount:1,phoneNumber:a.value.phoneNumber};const b=await s.checkOut(f);console.log(b,"Mpesa"),i.value=!1,l.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(r){console.log("Error placing order:",r),i.value=!1,l.add({severity:"error",summary:"Error placing order",detail:r.message,group:"br",life:3e3})}else{if(!a.value||Object.keys(a.value).length===0){l.add({severity:"warn",summary:"Please Enter your details to place an order.",group:"br",life:3e3});return}for(const r of y)if(!a.value[r]){l.add({severity:"warn",summary:`${r} is required to place an order.`,group:"br",life:3e3});return}try{i.value=!0;let f={orderId:(await s.placeOrderAnonymous(a.value)).data.id,amount:1,phoneNumber:a.value.phoneNumber};const b=await s.checkOut(f);console.log(b,"Mpesa"),i.value=!1,l.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(r){console.log("Error placing order:",r),i.value=!1,l.add({severity:"error",summary:"Error placing order",detail:r.message,group:"br",life:3e3})}}};return G(()=>{}),{user:a,cartItems:w,cartTotal:I,coupon:m,applyCoupon:p,placeOrder:x,formattedPrice:P,loading:i,defaultImage:W,home:k,items:N,getVat:t}}},H={class:"container mx-auto pt-12"},Q=["href","onClick"],Z={class:"text-primary font-semibold"},$=["href","target"],ee={class:"text-surface-700 dark:text-surface-0"},oe={class:"checkout-container flex flex-col md:flex-row gap-8 p-4 md:p-8"},te={class:"billing-details flex-1 bg-white p-6 rounded-lg shadow mb-4"},se={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},re={class:"form-group"},le={class:"form-group"},ae={class:"form-group"},ne={class:"form-group"},de={class:"form-group"},ie={class:"form-group"},me={class:"form-group"},ue={class:"form-group"},ce={class:"cart-summary bg-white p-6 flex-1 rounded-lg w-full md:max-w-sm shadow"},pe={class:"cart-items space-y-4"},fe=["src","alt"],be={class:"flex-1 text-center sm:text-left"},ge={class:"text-sm"},ye={class:"flex justify-between"},xe={class:"text-gray-600 text-xs"},ve={class:"text-sm"},he={class:"cart-summary-bottom mt-4"},_e={class:"flex justify-between text-sm"},we={class:"text-lg"},ke={class:"text-gray-600 flex justify-between"},Ne={class:"flex justify-between text-lg font-semibold"},Pe={class:"text-lg"},Te={class:"payment-methods flex flex-col sm:flex-row items-center gap-2 mt-4"},Ce={class:"text-sm font-medium"};function Oe(i,o,_,s,I,w){var y;const a=K("router-link"),k=E,N=A,P=q;return g(),h("div",H,[O(k,{home:s.home,model:s.items},{item:U(({item:t,props:m})=>[t.route?(g(),z(a,{key:0,to:t.route,custom:""},{default:U(({href:p,navigate:l})=>[e("a",M({href:p},m.action,{onClick:l}),[e("span",{class:J([t.icon,"text-color"])},null,2),e("span",Z,d(t.label),1)],16,Q)]),_:2},1032,["to"])):(g(),h("a",M({key:1,href:t.url,target:t.target},m.action),[e("span",ee,d(t.label),1)],16,$))]),_:1},8,["home","model"]),e("div",oe,[e("div",te,[o[17]||(o[17]=e("h2",{class:"text-xl font-semibold mb-4"},"Billing Details",-1)),e("form",se,[e("div",re,[o[9]||(o[9]=e("label",{for:"first-name",class:"block text-sm font-medium mb-1"},"First Name*",-1)),u(e("input",{type:"text",id:"first-name","onUpdate:modelValue":o[0]||(o[0]=t=>s.user.firstName=t),placeholder:"First Name",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.firstName]])]),e("div",le,[o[10]||(o[10]=e("label",{for:"last-name",class:"block text-sm font-medium mb-1"},"Last Name*",-1)),u(e("input",{type:"text",id:"last-name","onUpdate:modelValue":o[1]||(o[1]=t=>s.user.lastName=t),placeholder:"Last Name",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.lastName]])]),e("div",ae,[o[11]||(o[11]=e("label",{for:"company-name",class:"block text-sm font-medium mb-1"},"Company Name",-1)),u(e("input",{type:"text",id:"company-name","onUpdate:modelValue":o[2]||(o[2]=t=>s.user.company_name=t),placeholder:"Company Name",class:"w-full p-2 border rounded"},null,512),[[c,s.user.company_name]])]),e("div",ne,[o[12]||(o[12]=e("label",{for:"street-address",class:"block text-sm font-medium mb-1"},"Street Address*",-1)),u(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>s.user.street_address=t),id:"street-address",placeholder:"Street Address",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.street_address]])]),e("div",de,[o[13]||(o[13]=e("label",{for:"apartment",class:"block text-sm font-medium mb-1"},"Apartment, floor, etc. (optional)",-1)),u(e("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>s.user.apartment=t),id:"apartment",placeholder:"Apartment, floor, etc.",class:"w-full p-2 border rounded"},null,512),[[c,s.user.apartment]])]),e("div",ie,[o[14]||(o[14]=e("label",{for:"city",class:"block text-sm font-medium mb-1"},"Town/City*",-1)),u(e("input",{type:"text",id:"city","onUpdate:modelValue":o[5]||(o[5]=t=>s.user.town=t),placeholder:"Town/City",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.town]])]),e("div",me,[o[15]||(o[15]=e("label",{for:"phone",class:"block text-sm font-medium mb-1"},"Phone Number*",-1)),u(e("input",{type:"tel",id:"phone","onUpdate:modelValue":o[6]||(o[6]=t=>s.user.phoneNumber=t),placeholder:"Phone Number",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.phoneNumber]])]),e("div",ue,[o[16]||(o[16]=e("label",{for:"email",class:"block text-sm font-medium mb-1"},"Email Address*",-1)),u(e("input",{type:"email",id:"email","onUpdate:modelValue":o[7]||(o[7]=t=>s.user.email=t),placeholder:"Email Address",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.email]])])])]),e("div",ce,[o[24]||(o[24]=e("h3",{class:"text-lg font-semibold mb-4"},"Cart Summary",-1)),e("div",pe,[(g(!0),h(R,null,Y(s.cartItems,t=>{var m,p,l,x,n,r,f,b,S;return g(),h("div",{key:t.id,class:"cart-item flex flex-col sm:flex-row items-center gap-4 border-b pb-3"},[e("img",{src:((l=(p=(m=t.productModel)==null?void 0:m.images)==null?void 0:p.find(T=>T.isPrimary))==null?void 0:l.uploadUrl)??((n=(x=t==null?void 0:t.images)==null?void 0:x.find(T=>T.isPrimary))==null?void 0:n.uploadUrl),alt:((r=t.productModel)==null?void 0:r.name)||"Product Image",class:"w-full h-40 object-cover"},null,8,fe),e("div",be,[e("p",ge,d(((f=t==null?void 0:t.productModel)==null?void 0:f.name)??t.name),1),e("div",ye,[e("p",xe," Ksh "+d(s.formattedPrice(((b=t.productModel)==null?void 0:b.price)??t.price)),1),e("p",ve,d(((S=t==null?void 0:t.productModel)==null?void 0:S.quantity)??t.quantity),1)])])])}),128))]),e("div",he,[e("p",_e,[o[18]||(o[18]=V(" Subtotal ")),e("strong",we,d(s.formattedPrice(s.cartTotal)),1)]),e("p",ke,[o[19]||(o[19]=V(" VAT (16%): ")),e("strong",null,d(s.formattedPrice(s.getVat(s.cartTotal))),1)]),o[22]||(o[22]=e("hr",{class:"my-2"},null,-1)),o[23]||(o[23]=e("hr",{class:"my-2"},null,-1)),e("p",Ne,[o[20]||(o[20]=V(" Total ")),e("strong",Pe,"Ksh "+d(s.formattedPrice(s.cartTotal+s.getVat(s.cartTotal))),1)]),e("div",Te,[o[21]||(o[21]=e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/512px-M-PESA_LOGO-01.svg.png?20191120100524",class:"w-16 sm:w-1/4",alt:"M-Pesa"},null,-1)),e("label",Ce,d((y=s.user)==null?void 0:y.phoneNumber),1)]),O(N,{type:"button",class:"place-order-btn w-full bg-green-600 text-white py-2 mt-4 rounded-lg hover:bg-green-700",label:"Place Order",loading:s.loading,onClick:o[8]||(o[8]=t=>s.placeOrder())},null,8,["loading"])])])]),O(P,{position:"top-right",group:"br"})])}const Be=L(X,[["render",Oe],["__scopeId","data-v-5cd20627"]]);export{Be as default};
