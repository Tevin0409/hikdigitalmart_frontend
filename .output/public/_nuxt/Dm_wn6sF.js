import{s as U}from"./lCz-IEOs.js";import{s as q}from"./DFzaI22G.js";import{s as A}from"./BRhSRpvs.js";import{_ as E,r as y,y as M,x as L,J as B,R as C,U as j,S as F,q as D,c as x,b as V,w as I,a as e,N as u,V as c,F as G,m as R,d as O,t as d,o as f,G as z,u as K,v as S}from"./jSwVqkrp.js";import{_ as Y}from"./D6LJFPfn.js";import"./bobFoklE.js";import"./DdvFyE0G.js";import"./S0SdMC8m.js";import"./DaMNRX3T.js";import"./EAO2K0KV.js";const J={setup(){const i=y(!1),{$formatPrice:o}=M(),v=L(),s=B(),P=C(()=>s.cartTotal),h=C(()=>s.cartItems),l=C(()=>v.user||{}),_=y({icon:"pi pi-home",route:"/dashboard"}),w=y([{label:"Cart",route:"/cart"},{label:"Checkout",route:"/checkout"}]),k=a=>o(a),b=["firstName","lastName","email","phoneNumber"],t=a=>a*.16,m=y(""),p=()=>{m.value==="DISCOUNT10"?(h.value.forEach(a=>{a.product.price=a.product.price*.9}),alert("Coupon applied: 10% discount!")):alert("Invalid coupon code.")},r=j(),g=async()=>{if(v.isLoggedIn)try{i.value=!0;let N={orderId:(await s.placeOrder(l.value)).data.id,amount:1,phoneNumber:l.value.phoneNumber};const T=await s.checkOut(N);console.log(T,"Mpesa"),i.value=!1,r.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(n){console.log("Error placing order:",n),i.value=!1,r.add({severity:"error",summary:"Error placing order",detail:n.message,group:"br",life:3e3})}else{if(!l.value||Object.keys(l.value).length===0){r.add({severity:"warn",summary:"Please Enter your details to place an order.",group:"br",life:3e3});return}for(const n of b)if(!l.value[n]){r.add({severity:"warn",summary:`${n} is required to place an order.`,group:"br",life:3e3});return}try{i.value=!0;let N={orderId:(await s.placeOrderAnonymous(l.value)).data.id,amount:1,phoneNumber:l.value.phoneNumber};const T=await s.checkOut(N);console.log(T,"Mpesa"),i.value=!1,r.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(n){console.log("Error placing order:",n),i.value=!1,r.add({severity:"error",summary:"Error placing order",detail:n.message,group:"br",life:3e3})}}};return F(()=>{}),{user:l,cartItems:h,cartTotal:P,coupon:m,applyCoupon:p,placeOrder:g,formattedPrice:k,loading:i,defaultImage:Y,home:_,items:w,getVat:t}}},H={class:"container mx-auto pt-12"},Q=["href","onClick"],W={class:"text-primary font-semibold"},X=["href","target"],Z={class:"text-surface-700 dark:text-surface-0"},$={class:"checkout-container flex flex-col md:flex-row gap-8 p-4 md:p-8"},ee={class:"billing-details flex-1 bg-white p-6 rounded-lg shadow mb-4"},oe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},te={class:"form-group"},se={class:"form-group"},re={class:"form-group"},le={class:"form-group"},ae={class:"form-group"},ne={class:"form-group"},de={class:"form-group"},ie={class:"form-group"},me={class:"cart-summary bg-white p-6 flex-1 rounded-lg w-full md:max-w-sm shadow"},ue={class:"cart-items space-y-4"},ce=["src"],pe={class:"flex-1 text-center sm:text-left"},fe={class:"text-sm"},be={class:"flex justify-between"},ge={class:"text-gray-600 text-xs"},ye={class:"text-sm"},xe={class:"cart-summary-bottom mt-4"},ve={class:"flex justify-between text-sm"},he={class:"text-lg"},_e={class:"text-gray-600 flex justify-between"},we={class:"flex justify-between text-lg font-semibold"},ke={class:"text-lg"},Ne={class:"payment-methods flex flex-col sm:flex-row items-center gap-2 mt-4"},Te={class:"text-sm font-medium"};function Ce(i,o,v,s,P,h){var b;const l=D("router-link"),_=A,w=q,k=U;return f(),x("div",H,[V(_,{home:s.home,model:s.items},{item:I(({item:t,props:m})=>[t.route?(f(),z(l,{key:0,to:t.route,custom:""},{default:I(({href:p,navigate:r})=>[e("a",S({href:p},m.action,{onClick:r}),[e("span",{class:K([t.icon,"text-color"])},null,2),e("span",W,d(t.label),1)],16,Q)]),_:2},1032,["to"])):(f(),x("a",S({key:1,href:t.url,target:t.target},m.action),[e("span",Z,d(t.label),1)],16,X))]),_:1},8,["home","model"]),e("div",$,[e("div",ee,[o[17]||(o[17]=e("h2",{class:"text-xl font-semibold mb-4"},"Billing Details",-1)),e("form",oe,[e("div",te,[o[9]||(o[9]=e("label",{for:"first-name",class:"block text-sm font-medium mb-1"},"First Name*",-1)),u(e("input",{type:"text",id:"first-name","onUpdate:modelValue":o[0]||(o[0]=t=>s.user.firstName=t),placeholder:"First Name",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.firstName]])]),e("div",se,[o[10]||(o[10]=e("label",{for:"last-name",class:"block text-sm font-medium mb-1"},"Last Name*",-1)),u(e("input",{type:"text",id:"last-name","onUpdate:modelValue":o[1]||(o[1]=t=>s.user.lastName=t),placeholder:"Last Name",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.lastName]])]),e("div",re,[o[11]||(o[11]=e("label",{for:"company-name",class:"block text-sm font-medium mb-1"},"Company Name",-1)),u(e("input",{type:"text",id:"company-name","onUpdate:modelValue":o[2]||(o[2]=t=>s.user.company_name=t),placeholder:"Company Name",class:"w-full p-2 border rounded"},null,512),[[c,s.user.company_name]])]),e("div",le,[o[12]||(o[12]=e("label",{for:"street-address",class:"block text-sm font-medium mb-1"},"Street Address*",-1)),u(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>s.user.street_address=t),id:"street-address",placeholder:"Street Address",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.street_address]])]),e("div",ae,[o[13]||(o[13]=e("label",{for:"apartment",class:"block text-sm font-medium mb-1"},"Apartment, floor, etc. (optional)",-1)),u(e("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>s.user.apartment=t),id:"apartment",placeholder:"Apartment, floor, etc.",class:"w-full p-2 border rounded"},null,512),[[c,s.user.apartment]])]),e("div",ne,[o[14]||(o[14]=e("label",{for:"city",class:"block text-sm font-medium mb-1"},"Town/City*",-1)),u(e("input",{type:"text",id:"city","onUpdate:modelValue":o[5]||(o[5]=t=>s.user.town=t),placeholder:"Town/City",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.town]])]),e("div",de,[o[15]||(o[15]=e("label",{for:"phone",class:"block text-sm font-medium mb-1"},"Phone Number*",-1)),u(e("input",{type:"tel",id:"phone","onUpdate:modelValue":o[6]||(o[6]=t=>s.user.phoneNumber=t),placeholder:"Phone Number",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.phoneNumber]])]),e("div",ie,[o[16]||(o[16]=e("label",{for:"email",class:"block text-sm font-medium mb-1"},"Email Address*",-1)),u(e("input",{type:"email",id:"email","onUpdate:modelValue":o[7]||(o[7]=t=>s.user.email=t),placeholder:"Email Address",required:"",class:"w-full p-2 border rounded"},null,512),[[c,s.user.email]])])])]),e("div",me,[o[24]||(o[24]=e("h3",{class:"text-lg font-semibold mb-4"},"Cart Summary",-1)),e("div",ue,[(f(!0),x(G,null,R(s.cartItems,t=>{var m,p,r,g,a;return f(),x("div",{key:t.id,class:"cart-item flex flex-col sm:flex-row items-center gap-4 border-b pb-3"},[e("img",{src:((p=(m=t==null?void 0:t.productModel)==null?void 0:m.images[0])==null?void 0:p.optimizeUrl)??s.defaultImage,class:"w-16 h-16 object-cover rounded"},null,8,ce),e("div",pe,[e("p",fe,d(((r=t==null?void 0:t.productModel)==null?void 0:r.name)??t.name),1),e("div",be,[e("p",ge," Ksh "+d(s.formattedPrice(((g=t.productModel)==null?void 0:g.price)??t.price)),1),e("p",ye,d(((a=t==null?void 0:t.productModel)==null?void 0:a.quantity)??t.quantity),1)])])])}),128))]),e("div",xe,[e("p",ve,[o[18]||(o[18]=O(" Subtotal ")),e("strong",he,d(s.formattedPrice(s.cartTotal)),1)]),e("p",_e,[o[19]||(o[19]=O(" VAT (16%): ")),e("strong",null,d(s.formattedPrice(s.getVat(s.cartTotal))),1)]),o[22]||(o[22]=e("hr",{class:"my-2"},null,-1)),o[23]||(o[23]=e("hr",{class:"my-2"},null,-1)),e("p",we,[o[20]||(o[20]=O(" Total ")),e("strong",ke,"Ksh "+d(s.formattedPrice(s.cartTotal+s.getVat(s.cartTotal))),1)]),e("div",Ne,[o[21]||(o[21]=e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/512px-M-PESA_LOGO-01.svg.png?20191120100524",class:"w-16 sm:w-1/4",alt:"M-Pesa"},null,-1)),e("label",Te,d((b=s.user)==null?void 0:b.phoneNumber),1)]),V(w,{type:"button",class:"place-order-btn w-full bg-green-600 text-white py-2 mt-4 rounded-lg hover:bg-green-700",label:"Place Order",loading:s.loading,onClick:o[8]||(o[8]=t=>s.placeOrder())},null,8,["loading"])])])]),V(k,{position:"top-right",group:"br"})])}const Le=E(J,[["render",Ce],["__scopeId","data-v-035919ab"]]);export{Le as default};
