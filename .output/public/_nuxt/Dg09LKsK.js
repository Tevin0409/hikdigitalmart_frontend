import{s as E}from"./BT1qGypU.js";import{s as M}from"./BSMKkSN6.js";import{s as j}from"./CJDQCnFe.js";import{_ as B,r as w,y as L,x as F,J as D,S as O,W as G,U as K,q as R,c as h,b as U,w as A,a as o,N as u,X as p,F as Y,m as z,d as I,t as m,V as J,I as S,o as b,G as W,u as X,v as q}from"./2054L8v-.js";import{_ as H}from"./BStA76-v.js";import"./GYWaLpTV.js";import"./3gxoszUO.js";import"./e22MuQnA.js";import"./IalVA8gP.js";const Q={setup(){const c=w(!1),{$formatPrice:e}=L(),N=F(),s=D(),g=O(()=>s.cartTotal),V=O(()=>s.cartItems),n=w(!1),r=O(()=>N.user||{}),C=w({icon:"pi pi-home",route:"/dashboard"}),P=w([{label:"Cart",route:"/cart"},{label:"Checkout",route:"/checkout"}]),y=a=>e(a),t=["firstName","lastName","email","phoneNumber"],d=a=>a*.16,f=w(""),x=()=>{f.value==="DISCOUNT10"?(V.value.forEach(a=>{a.product.price=a.product.price*.9}),alert("Coupon applied: 10% discount!")):alert("Invalid coupon code.")},i=G(),_=async()=>{const a=N.isLoggedIn;if(console.log("isVat.value,",n.value),a){r.value={...r.value,isVat:n.value};try{c.value=!0;let v={orderId:(await s.placeOrder(r.value,n.value)).data.id,amount:y(g+(n.value?d(g):0)),phoneNumber:r.value.phoneNumber};const k=await s.checkOut(v);c.value=!1,i.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(l){console.log("Error placing order:",l),c.value=!1,i.add({severity:"error",summary:"Error placing order",detail:l.message,group:"br",life:3e3})}}else{if(!r.value||Object.keys(r.value).length===0){i.add({severity:"warn",summary:"Please Enter your details to place an order.",group:"br",life:3e3});return}for(const l of t)if(!r.value[l]){i.add({severity:"warn",summary:`${l} is required to place an order.`,group:"br",life:3e3});return}try{r.value={...r.value,isVat:n.value},c.value=!0;let v={orderId:(await s.placeOrderAnonymous(r.value,n.value)).data.id,amount:y(g+(n.value?d(g):0)),phoneNumber:r.value.phoneNumber};const k=await s.checkOut(v);c.value=!1,i.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(l){console.log("Error placing order:",l),c.value=!1,i.add({severity:"error",summary:"Error placing order",detail:l.message,group:"br",life:3e3})}}};return K(()=>{}),{user:r,cartItems:V,cartTotal:g,coupon:f,applyCoupon:x,placeOrder:_,formattedPrice:y,loading:c,defaultImage:H,home:C,items:P,getVat:d,isVat:n}}},Z={class:"container mx-auto pt-12"},$=["href","onClick"],ee={class:"text-primary font-semibold"},oe=["href","target"],te={class:"text-surface-700 dark:text-surface-0"},se={class:"checkout-container flex flex-col md:flex-row gap-8 p-4 md:p-8"},re={class:"billing-details flex-1 bg-white p-6 rounded-lg shadow mb-4"},le={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ae={class:"form-group"},ne={class:"form-group"},de={class:"form-group"},ie={class:"form-group"},ue={class:"form-group"},me={class:"form-group"},ce={class:"form-group"},pe={class:"form-group"},fe={class:"cart-summary bg-white p-6 flex-1 rounded-lg w-full md:max-w-sm shadow"},be={class:"cart-items space-y-4"},ge=["src","alt"],ye={class:"flex-1 text-center sm:text-left"},xe={class:"text-sm"},ve={class:"flex justify-between"},he={class:"text-gray-600 text-xs"},we={class:"text-sm"},_e={class:"cart-summary-bottom mt-4"},ke={class:"flex justify-between text-sm"},Ne={class:"text-lg"},Ve={class:"flex items-center justify-between my-4"},Ce={class:"relative inline-flex items-center cursor-pointer"},Pe={key:0,class:"my-2"},Te={key:1,class:"flex justify-between text-gray-600"},Oe={class:"flex justify-between text-lg font-semibold"},Ue={class:"text-lg"},Ae={class:"payment-methods flex flex-col sm:flex-row items-center gap-2 mt-4"},Ie={class:"text-sm font-medium"};function Se(c,e,N,s,g,V){var y;const n=R("router-link"),r=j,C=M,P=E;return b(),h("div",Z,[U(r,{home:s.home,model:s.items},{item:A(({item:t,props:d})=>[t.route?(b(),W(n,{key:0,to:t.route,custom:""},{default:A(({href:f,navigate:x})=>[o("a",q({href:f},d.action,{onClick:x}),[o("span",{class:X([t.icon,"text-color"])},null,2),o("span",ee,m(t.label),1)],16,$)]),_:2},1032,["to"])):(b(),h("a",q({key:1,href:t.url,target:t.target},d.action),[o("span",te,m(t.label),1)],16,oe))]),_:1},8,["home","model"]),o("div",se,[o("div",re,[e[18]||(e[18]=o("h2",{class:"text-xl font-semibold mb-4"},"Billing Details",-1)),o("form",le,[o("div",ae,[e[10]||(e[10]=o("label",{for:"first-name",class:"block text-sm font-medium mb-1"},"First Name*",-1)),u(o("input",{type:"text",id:"first-name","onUpdate:modelValue":e[0]||(e[0]=t=>s.user.firstName=t),placeholder:"First Name",required:"",class:"w-full p-2 border rounded"},null,512),[[p,s.user.firstName]])]),o("div",ne,[e[11]||(e[11]=o("label",{for:"last-name",class:"block text-sm font-medium mb-1"},"Last Name*",-1)),u(o("input",{type:"text",id:"last-name","onUpdate:modelValue":e[1]||(e[1]=t=>s.user.lastName=t),placeholder:"Last Name",required:"",class:"w-full p-2 border rounded"},null,512),[[p,s.user.lastName]])]),o("div",de,[e[12]||(e[12]=o("label",{for:"company-name",class:"block text-sm font-medium mb-1"},"Company Name",-1)),u(o("input",{type:"text",id:"company-name","onUpdate:modelValue":e[2]||(e[2]=t=>s.user.company_name=t),placeholder:"Company Name",class:"w-full p-2 border rounded"},null,512),[[p,s.user.company_name]])]),o("div",ie,[e[13]||(e[13]=o("label",{for:"street-address",class:"block text-sm font-medium mb-1"},"Street Address*",-1)),u(o("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>s.user.street_address=t),id:"street-address",placeholder:"Street Address",required:"",class:"w-full p-2 border rounded"},null,512),[[p,s.user.street_address]])]),o("div",ue,[e[14]||(e[14]=o("label",{for:"apartment",class:"block text-sm font-medium mb-1"},"Apartment, floor, etc. (optional)",-1)),u(o("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>s.user.apartment=t),id:"apartment",placeholder:"Apartment, floor, etc.",class:"w-full p-2 border rounded"},null,512),[[p,s.user.apartment]])]),o("div",me,[e[15]||(e[15]=o("label",{for:"city",class:"block text-sm font-medium mb-1"},"Town/City*",-1)),u(o("input",{type:"text",id:"city","onUpdate:modelValue":e[5]||(e[5]=t=>s.user.town=t),placeholder:"Town/City",required:"",class:"w-full p-2 border rounded"},null,512),[[p,s.user.town]])]),o("div",ce,[e[16]||(e[16]=o("label",{for:"phone",class:"block text-sm font-medium mb-1"},"Phone Number*",-1)),u(o("input",{type:"tel",id:"phone","onUpdate:modelValue":e[6]||(e[6]=t=>s.user.phoneNumber=t),placeholder:"Phone Number",required:"",class:"w-full p-2 border rounded"},null,512),[[p,s.user.phoneNumber]])]),o("div",pe,[e[17]||(e[17]=o("label",{for:"email",class:"block text-sm font-medium mb-1"},"Email Address*",-1)),u(o("input",{type:"email",id:"email","onUpdate:modelValue":e[7]||(e[7]=t=>s.user.email=t),placeholder:"Email Address",required:"",class:"w-full p-2 border rounded"},null,512),[[p,s.user.email]])])])]),o("div",fe,[e[27]||(e[27]=o("h3",{class:"text-lg font-semibold mb-4"},"Cart Summary",-1)),o("div",be,[(b(!0),h(Y,null,z(s.cartItems,t=>{var d,f,x,i,_,a,l,v,k;return b(),h("div",{key:t.id,class:"cart-item flex flex-col sm:flex-row items-center gap-4 border-b pb-3"},[o("img",{src:((x=(f=(d=t.productModel)==null?void 0:d.images)==null?void 0:f.find(T=>T.isPrimary))==null?void 0:x.uploadUrl)??((_=(i=t==null?void 0:t.images)==null?void 0:i.find(T=>T.isPrimary))==null?void 0:_.uploadUrl),alt:((a=t.productModel)==null?void 0:a.name)||"Product Image",class:"w-full h-40 object-cover"},null,8,ge),o("div",ye,[o("p",xe,m(((l=t==null?void 0:t.productModel)==null?void 0:l.name)??t.name),1),o("div",ve,[o("p",he," Ksh "+m(s.formattedPrice(((v=t.productModel)==null?void 0:v.price)??t.price)),1),o("p",we,m(((k=t==null?void 0:t.productModel)==null?void 0:k.quantity)??t.quantity),1)])])])}),128))]),o("div",_e,[o("p",ke,[e[19]||(e[19]=I(" Subtotal ")),o("strong",Ne,m(s.formattedPrice(s.cartTotal)),1)]),o("div",Ve,[e[22]||(e[22]=o("label",{class:"text-gray-600"},"Apply VAT (16%)",-1)),o("label",Ce,[u(o("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>s.isVat=t),class:"sr-only peer"},null,512),[[J,s.isVat]]),e[20]||(e[20]=o("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-primary transition-colors"},null,-1)),e[21]||(e[21]=o("div",{class:"absolute left-1 top-1 bg-white border border-gray-300 w-4 h-4 rounded-full transition-transform peer-checked:translate-x-5"},null,-1))])]),s.isVat?(b(),h("hr",Pe)):S("",!0),s.isVat?(b(),h("div",Te,[e[23]||(e[23]=o("span",null,"VAT",-1)),o("span",null,"Ksh "+m(s.formattedPrice(s.getVat(s.cartTotal))),1)])):S("",!0),e[26]||(e[26]=o("hr",{class:"my-2"},null,-1)),o("p",Oe,[e[24]||(e[24]=I(" Total ")),o("strong",Ue,"Ksh "+m(s.formattedPrice(s.cartTotal+(s.isVat?s.getVat(s.cartTotal):0))),1)]),o("div",Ae,[e[25]||(e[25]=o("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/512px-M-PESA_LOGO-01.svg.png?20191120100524",class:"w-16 sm:w-1/4",alt:"M-Pesa"},null,-1)),o("label",Ie,m((y=s.user)==null?void 0:y.phoneNumber),1)]),U(C,{type:"button",class:"place-order-btn w-full bg-green-600 text-white py-2 mt-4 rounded-lg hover:bg-green-700",label:"Place Order",loading:s.loading,onClick:e[9]||(e[9]=t=>s.placeOrder())},null,8,["loading"])])])]),U(P,{position:"top-right",group:"br"})])}const Ke=B(Q,[["render",Se],["__scopeId","data-v-242882a1"]]);export{Ke as default};
