import{s as U}from"./BOKZX5Q4.js";import{s as V}from"./Dw08hpSO.js";import{s as q}from"./CEOHXjAF.js";import{_ as E,r as g,y as M,x as A,J as L,R as C,U as B,S as j,q as F,c as x,b as O,w as T,a as e,N as i,V as m,F as D,m as G,d as I,t as u,o as f,G as R,u as z,v as S}from"./BEjfRqa4.js";import{_ as K}from"./DotXfzdA.js";import"./z6DlsYYX.js";import"./CymfgsnO.js";import"./ClYAvl-m.js";import"./BR1eof9G.js";import"./YBik_lWT.js";const Y={setup(){const n=g(!1),{$formatPrice:o}=M(),y=A(),t=L(),P=C(()=>t.cartTotal),v=C(()=>t.cartItems),a=C(()=>y.user||{}),h=g({icon:"pi pi-home",route:"/dashboard"}),_=g([{label:"Cart",route:"/cart"},{label:"Checkout",route:"/checkout"}]),w=d=>o(d),b=["firstName","lastName","email","phoneNumber"],s=g(""),c=()=>{s.value==="DISCOUNT10"?(v.value.forEach(d=>{d.product.price=d.product.price*.9}),alert("Coupon applied: 10% discount!")):alert("Invalid coupon code.")},l=B(),p=async()=>{if(y.isLoggedIn)try{n.value=!0;let k={orderId:(await t.placeOrder(a.value)).data.id,amount:1,phoneNumber:a.value.phoneNumber};const N=await t.checkOut(k);console.log(N,"Mpesa"),n.value=!1,l.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(r){console.log("Error placing order:",r),n.value=!1,l.add({severity:"error",summary:"Error placing order",detail:r.message,group:"br",life:3e3})}else{if(!a.value||Object.keys(a.value).length===0){l.add({severity:"warn",summary:"Please Enter your details to place an order.",group:"br",life:3e3});return}for(const r of b)if(!a.value[r]){l.add({severity:"warn",summary:`${r} is required to place an order.`,group:"br",life:3e3});return}try{n.value=!0;let k={orderId:(await t.placeOrderAnonymous(a.value)).data.id,amount:1,phoneNumber:a.value.phoneNumber};const N=await t.checkOut(k);console.log(N,"Mpesa"),n.value=!1,l.add({severity:"success",summary:"Your Order has been placed successfully, Thank you",group:"br",life:3e3})}catch(r){console.log("Error placing order:",r),n.value=!1,l.add({severity:"error",summary:"Error placing order",detail:r.message,group:"br",life:3e3})}}};return j(()=>{}),{user:a,cartItems:v,cartTotal:P,coupon:s,applyCoupon:c,placeOrder:p,formattedPrice:w,loading:n,defaultImage:K,home:h,items:_}}},J={class:"container mx-auto pt-12"},H=["href","onClick"],Q={class:"text-primary font-semibold"},W=["href","target"],X={class:"text-surface-700 dark:text-surface-0"},Z={class:"checkout-container flex flex-col md:flex-row gap-8 p-4 md:p-8"},$={class:"billing-details flex-1 bg-white p-6 rounded-lg shadow mb-4"},ee={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},oe={class:"form-group"},se={class:"form-group"},te={class:"form-group"},re={class:"form-group"},le={class:"form-group"},ae={class:"form-group"},ne={class:"form-group"},de={class:"form-group"},ie={class:"cart-summary bg-white p-6 flex-1 rounded-lg w-full md:max-w-sm shadow"},me={class:"cart-items space-y-4"},ue=["src"],ce={class:"flex-1 text-center sm:text-left"},pe={class:"text-sm"},fe={class:"flex justify-between"},be={class:"text-gray-600 text-xs"},ge={class:"text-sm"},xe={class:"cart-summary-bottom mt-4"},ye={class:"flex justify-between text-sm"},ve={class:"text-lg"},he={class:"flex justify-between text-lg font-semibold"},_e={class:"text-lg"},we={class:"payment-methods flex flex-col sm:flex-row items-center gap-2 mt-4"},ke={class:"text-sm font-medium"};function Ne(n,o,y,t,P,v){var b;const a=F("router-link"),h=q,_=V,w=U;return f(),x("div",J,[O(h,{home:t.home,model:t.items},{item:T(({item:s,props:c})=>[s.route?(f(),R(a,{key:0,to:s.route,custom:""},{default:T(({href:l,navigate:p})=>[e("a",S({href:l},c.action,{onClick:p}),[e("span",{class:z([s.icon,"text-color"])},null,2),e("span",Q,u(s.label),1)],16,H)]),_:2},1032,["to"])):(f(),x("a",S({key:1,href:s.url,target:s.target},c.action),[e("span",X,u(s.label),1)],16,W))]),_:1},8,["home","model"]),e("div",Z,[e("div",$,[o[17]||(o[17]=e("h2",{class:"text-xl font-semibold mb-4"},"Billing Details",-1)),e("form",ee,[e("div",oe,[o[9]||(o[9]=e("label",{for:"first-name",class:"block text-sm font-medium mb-1"},"First Name*",-1)),i(e("input",{type:"text",id:"first-name","onUpdate:modelValue":o[0]||(o[0]=s=>t.user.firstName=s),placeholder:"First Name",required:"",class:"w-full p-2 border rounded"},null,512),[[m,t.user.firstName]])]),e("div",se,[o[10]||(o[10]=e("label",{for:"last-name",class:"block text-sm font-medium mb-1"},"Last Name*",-1)),i(e("input",{type:"text",id:"last-name","onUpdate:modelValue":o[1]||(o[1]=s=>t.user.lastName=s),placeholder:"Last Name",required:"",class:"w-full p-2 border rounded"},null,512),[[m,t.user.lastName]])]),e("div",te,[o[11]||(o[11]=e("label",{for:"company-name",class:"block text-sm font-medium mb-1"},"Company Name",-1)),i(e("input",{type:"text",id:"company-name","onUpdate:modelValue":o[2]||(o[2]=s=>t.user.company_name=s),placeholder:"Company Name",class:"w-full p-2 border rounded"},null,512),[[m,t.user.company_name]])]),e("div",re,[o[12]||(o[12]=e("label",{for:"street-address",class:"block text-sm font-medium mb-1"},"Street Address*",-1)),i(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=s=>t.user.street_address=s),id:"street-address",placeholder:"Street Address",required:"",class:"w-full p-2 border rounded"},null,512),[[m,t.user.street_address]])]),e("div",le,[o[13]||(o[13]=e("label",{for:"apartment",class:"block text-sm font-medium mb-1"},"Apartment, floor, etc. (optional)",-1)),i(e("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=s=>t.user.apartment=s),id:"apartment",placeholder:"Apartment, floor, etc.",class:"w-full p-2 border rounded"},null,512),[[m,t.user.apartment]])]),e("div",ae,[o[14]||(o[14]=e("label",{for:"city",class:"block text-sm font-medium mb-1"},"Town/City*",-1)),i(e("input",{type:"text",id:"city","onUpdate:modelValue":o[5]||(o[5]=s=>t.user.town=s),placeholder:"Town/City",required:"",class:"w-full p-2 border rounded"},null,512),[[m,t.user.town]])]),e("div",ne,[o[15]||(o[15]=e("label",{for:"phone",class:"block text-sm font-medium mb-1"},"Phone Number*",-1)),i(e("input",{type:"tel",id:"phone","onUpdate:modelValue":o[6]||(o[6]=s=>t.user.phoneNumber=s),placeholder:"Phone Number",required:"",class:"w-full p-2 border rounded"},null,512),[[m,t.user.phoneNumber]])]),e("div",de,[o[16]||(o[16]=e("label",{for:"email",class:"block text-sm font-medium mb-1"},"Email Address*",-1)),i(e("input",{type:"email",id:"email","onUpdate:modelValue":o[7]||(o[7]=s=>t.user.email=s),placeholder:"Email Address",required:"",class:"w-full p-2 border rounded"},null,512),[[m,t.user.email]])])])]),e("div",ie,[o[22]||(o[22]=e("h3",{class:"text-lg font-semibold mb-4"},"Cart Summary",-1)),e("div",me,[(f(!0),x(D,null,G(t.cartItems,s=>{var c,l,p,d,r;return f(),x("div",{key:s.id,class:"cart-item flex flex-col sm:flex-row items-center gap-4 border-b pb-3"},[e("img",{src:((l=(c=s==null?void 0:s.productModel)==null?void 0:c.images[0])==null?void 0:l.optimizeUrl)??t.defaultImage,class:"w-16 h-16 object-cover rounded"},null,8,ue),e("div",ce,[e("p",pe,u(((p=s==null?void 0:s.productModel)==null?void 0:p.name)??s.name),1),e("div",fe,[e("p",be," Ksh "+u(t.formattedPrice(((d=s.productModel)==null?void 0:d.price)??s.price)),1),e("p",ge,u(((r=s==null?void 0:s.productModel)==null?void 0:r.quantity)??s.quantity),1)])])])}),128))]),e("div",xe,[e("p",ye,[o[18]||(o[18]=I(" Subtotal ")),e("strong",ve,u(t.formattedPrice(t.cartTotal)),1)]),o[21]||(o[21]=e("hr",{class:"my-2"},null,-1)),e("p",he,[o[19]||(o[19]=I(" Total ")),e("strong",_e,"Ksh "+u(t.formattedPrice(t.cartTotal)),1)]),e("div",we,[o[20]||(o[20]=e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/512px-M-PESA_LOGO-01.svg.png?20191120100524",class:"w-16 sm:w-1/4",alt:"M-Pesa"},null,-1)),e("label",ke,u((b=t.user)==null?void 0:b.phoneNumber),1)]),O(_,{type:"button",class:"place-order-btn w-full bg-green-600 text-white py-2 mt-4 rounded-lg hover:bg-green-700",label:"Place Order",loading:t.loading,onClick:o[8]||(o[8]=s=>t.placeOrder())},null,8,["loading"])])])]),O(w,{position:"top-right",group:"br"})])}const Me=E(Y,[["render",Ne],["__scopeId","data-v-c242d491"]]);export{Me as default};
